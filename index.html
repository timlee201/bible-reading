<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Testament Reading Schedule</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
        }
        .collapsible {
            background-color: #f4f4f4;
            color: black;
            cursor: pointer;
            padding: 10px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 18px;
            margin-top: 10px;
        }
        .collapsible.active, .collapsible:hover {
            background-color: #ccc;
        }
        .content {
            padding: 0 10px;
            display: none;
            overflow: hidden;
            border: 1px solid #ccc;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        input[type="checkbox"] {
            cursor: pointer;
        }
        .toggle-buttons {
            margin: 10px 0;
            text-align: right;
        }
        .hidden {
            display: none;
        }
        .icon-column {
            text-align: center;
            width: 50px;
        }
    </style>
</head>
<body>
    <h1>New Testament Reading Schedule</h1>

    <!-- Collapsible Section for Local Storage -->
    <button class="collapsible">Local Storage Method</button>
    <div class="content">
        <div class="toggle-buttons">
            <button onclick="toggleColumn('local', 'chapters')">Toggle Chapters</button>
            <button onclick="toggleColumn('local', 'verses')">Toggle Verses</button>
        </div>
        <table id="localTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Day</th>
                    <th>Books/Chapters Covered</th>
                    <th class="chapters hidden">Chapters</th>
                    <th class="verses hidden">Verses</th>
                    <th class="icon-column"><span title="Completed">✔️</span></th>
                </tr>
            </thead>
            <tbody>
                <!-- Rows will be dynamically added -->
            </tbody>
        </table>
    </div>

    <!-- Collapsible Section for Firebase -->
    <button class="collapsible">Firebase Method</button>
    <div class="content">
        <div class="toggle-buttons">
            <button onclick="toggleColumn('firebase', 'chapters')">Toggle Chapters</button>
            <button onclick="toggleColumn('firebase', 'verses')">Toggle Verses</button>
        </div>
        <table id="firebaseTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Day</th>
                    <th>Books/Chapters Covered</th>
                    <th class="chapters hidden">Chapters</th>
                    <th class="verses hidden">Verses</th>
                    <th class="icon-column"><span title="Completed">✔️</span></th>
                </tr>
            </thead>
            <tbody>
                <!-- Rows will be dynamically added -->
            </tbody>
        </table>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const schedule = [
            { date: "Fri 22 Nov", day: "Day 1", chapters: "Matthew 1–9", numChapters: 9, verses: 243 },
            { date: "Sat 23 Nov", day: "Day 2", chapters: "Matthew 10–18", numChapters: 9, verses: 236 },
            // Add more rows here...
        ];

        // Generate Local Storage Table
        const localTableBody = document.getElementById("localTable").querySelector("tbody");
        schedule.forEach((item, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${item.date}</td>
                <td>${item.day}</td>
                <td>${item.chapters}</td>
                <td class="chapters hidden">${item.numChapters}</td>
                <td class="verses hidden">${item.verses}</td>
                <td class="icon-column">
                    <input type="checkbox" id="localCheck${index}" onclick="saveProgressLocal(${index})">
                </td>
            `;
            localTableBody.appendChild(row);
        });

        // Generate Firebase Table
        const firebaseTableBody = document.getElementById("firebaseTable").querySelector("tbody");
        schedule.forEach((item, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${item.date}</td>
                <td>${item.day}</td>
                <td>${item.chapters}</td>
                <td class="chapters hidden">${item.numChapters}</td>
                <td class="verses hidden">${item.verses}</td>
                <td class="icon-column">
                    <input type="checkbox" id="firebaseCheck${index}" onclick="saveProgressFirebase(${index})">
                </td>
            `;
            firebaseTableBody.appendChild(row);
        });

        // Toggle visibility of columns
        function toggleColumn(section, columnClass) {
            const elements = document.querySelectorAll(`#${section}Table .${columnClass}`);
            elements.forEach(element => {
                element.classList.toggle('hidden');
            });
        }

        // Local Storage Logic
        function saveProgressLocal(index) {
            const checkbox = document.getElementById(`localCheck${index}`);
            localStorage.setItem(`localProgress${index}`, checkbox.checked);
        }

        function loadProgressLocal() {
            schedule.forEach((_, index) => {
                const checkbox = document.getElementById(`localCheck${index}`);
                const savedProgress = localStorage.getItem(`localProgress${index}`);
                if (savedProgress === "true") {
                    checkbox.checked = true;
                }
            });
        }

        // Firebase Logic
        function saveProgressFirebase(index) {
            const checkbox = document.getElementById(`firebaseCheck${index}`);
            const isChecked = checkbox.checked;
            const progressRef = firebase.database().ref(`progress/day${index}`);
            progressRef.set(isChecked);
        }

        function loadProgressFirebase() {
            const progressRef = firebase.database().ref('progress');
            progressRef.once('value', snapshot => {
                const progress = snapshot.val();
                if (progress) {
                    Object.keys(progress).forEach(key => {
                        const index = key.replace('day', '');
                        const checkbox = document.getElementById(`firebaseCheck${index}`);
                        if (checkbox) checkbox.checked = progress[key];
                    });
                }
            });
        }

        // Initialize collapsible sections
        const collapsibles = document.querySelectorAll(".collapsible");
        collapsibles.forEach(button => {
            button.addEventListener("click", function () {
                this.classList.toggle("active");
                const content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        });

        // Load progress on page load
        window.onload = () => {
            loadProgressLocal();
            loadProgressFirebase();
        };
    </script>
</body>
</html>
